# üéØ MIGRATION SUMMARY: SSG ‚Üí Node.js + ISR

## üìã –ù–∞–ø—Ä–∞–≤–µ–Ω–∏ –ü—Ä–æ–º–µ–Ω–∏

### ‚úÖ –ü—Ä–æ–º–µ–Ω–µ–Ω–∏ –§–∞–π–ª–æ–≤–µ

#### 1. **nuxt.config.ts** - –û—Å–Ω–æ–≤–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ü—Ä–µ–º–∞—Ö–Ω–∞—Ç–æ:**
- ‚ùå `generate: { fallback: true }` - –Ω–µ –Ω–∏ —Ç—Ä—è–±–≤–∞ –∑–∞ Node.js
- ‚ùå `crawlLinks: true` - –Ω–µ crawl-–≤–∞–º–µ –≤—Å–∏—á–∫–æ
- ‚ùå –¶–µ–ª–∏—è—Ç `hooks: { 'nitro:config' }` - 93-–º–∏–Ω—É—Ç–Ω–æ—Ç–æ fetch-–≤–∞–Ω–µ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏
- ‚ùå `prerender: true` –∑–∞ –≤—Å–∏—á–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤–∏ routes

**–î–æ–±–∞–≤–µ–Ω–æ:**
- ‚úÖ `preset: 'node-server'` - –ó–∞ Node.js + Passenger
- ‚úÖ `crawlLinks: false` - –°–∞–º–æ explicit routes
- ‚úÖ ISR route rules –∑–∞ –¥–∏–Ω–∞–º–∏—á–Ω–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∏:
  - `/produkt/**` - 5 –º–∏–Ω –∫–µ—à
  - `/product-cat/**` - 10 –º–∏–Ω –∫–µ—à
  - `/product-tag/**` - 10 –º–∏–Ω –∫–µ—à
  - `/marka-produkt/**` - 10 –º–∏–Ω –∫–µ—à
  - `/blog/**` - 10 –º–∏–Ω –∫–µ—à
  - `/magazin/**` - 5 –º–∏–Ω –∫–µ—à

**–ü—Ä–æ–º–µ–Ω–µ–Ω–æ:**
- üîÑ GraphQL cache: 15 –º–∏–Ω ‚Üí 2 –º–∏–Ω (ISR —Å–µ –≥—Ä–∏–∂–∏ –∑–∞ –∫–µ—à–∞)

#### 2. **package.json** - Build —Å–∫—Ä–∏–ø—Ç–æ–≤–µ

**–ü—Ä–µ–¥–∏:**
```json
"build": "nuxt generate"
```

**–°–ª–µ–¥:**
```json
"build": "nuxt build",
"start": "node .output/server/index.mjs",
"preview": "node .output/server/index.mjs"
```

#### 3. **.github/workflows/deploy.yml** - CI/CD

**–ì–æ–ª–µ–º–∏ –ø—Ä–æ–º–µ–Ω–∏:**

| –ü–∞—Ä–∞–º–µ—Ç—ä—Ä | –ü—Ä–µ–¥–∏ | –°–ª–µ–¥ |
|-----------|-------|------|
| Timeout | 120 –º–∏–Ω—É—Ç–∏ | 15 –º–∏–Ω—É—Ç–∏ |
| Build –∫–æ–º–∞–Ω–¥–∞ | `npm run generate` | `npm run build` |
| Deploy target | `.output/public/` | `.output/` + `package.json` |
| Target path | `/home/bgfreak/nodejs-apps/bgfreak/` | `/home/bgfreak/bgfreak-app/` |
| Restart –º–µ—Ç–æ–¥ | - | Passenger (`touch tmp/restart.txt`) |

**–ù–æ–≤–∏ —Å—Ç—ä–ø–∫–∏:**
- ‚úÖ Deploy –Ω–∞ `.output/` (—Ü—è–ª–∞—Ç–∞ –ø–∞–ø–∫–∞)
- ‚úÖ Deploy –Ω–∞ `package.json`, `package-lock.json`
- ‚úÖ `npm install --production` –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞
- ‚úÖ Passenger zero-downtime restart
- ‚úÖ Health check —Å–ª–µ–¥ deploy

### ‚úÖ –ù–æ–≤–∏ –§–∞–π–ª–æ–≤–µ

#### 4. **app.mjs** - Passenger Entry Point (–û–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω)

–ê–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–µ–Ω entry point –∑–∞ –ø–æ-–¥–æ–±—Ä–∞ —Å—ä–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç —Å Passenger.

#### 5. **.passenger** - Passenger Config

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞ Phusion Passenger:
- Entry point: `.output/server/index.mjs`
- App type: `node`
- Environment: `production`

#### 6. **DEPLOYMENT_GUIDE.md** - –ü—ä–ª–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–î–µ—Ç–∞–π–ª–Ω–æ —Ä—ä–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∑–∞ deployment –∏ troubleshooting.

#### 7. **QUICK_DEPLOY_INSTRUCTIONS.md** - –ë—ä—Ä–∑–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

–°—Ç—ä–ø–∫–∞ –ø–æ —Å—Ç—ä–ø–∫–∞ –∑–∞ –ø—ä—Ä–≤–æ–Ω–∞—á–∞–ª–µ–Ω setup (20 –º–∏–Ω—É—Ç–∏).

#### 8. **MIGRATION_SUMMARY.md** - –¢–æ–∑–∏ —Ñ–∞–π–ª

–û–±–æ–±—â–µ–Ω–∏–µ –Ω–∞ –≤—Å–∏—á–∫–∏ –ø—Ä–æ–º–µ–Ω–∏.

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –ü—Ä–µ–¥–∏ vs –°–ª–µ–¥

### Build & Deploy –í—Ä–µ–º–µ

| –ú–µ—Ç—Ä–∏–∫–∞ | –ü—Ä–µ–¥–∏ (SSG) | –°–ª–µ–¥ (Node.js + ISR) | –ü–æ–¥–æ–±—Ä–µ–Ω–∏–µ |
|---------|-------------|----------------------|------------|
| Build –≤—Ä–µ–º–µ | 93 –º–∏–Ω—É—Ç–∏ | 2-3 –º–∏–Ω—É—Ç–∏ | **31x –ø–æ-–±—ä—Ä–∑–æ** |
| Deploy –≤—Ä–µ–º–µ | 93 –º–∏–Ω—É—Ç–∏ | 3-5 –º–∏–Ω—É—Ç–∏ | **19x –ø–æ-–±—ä—Ä–∑–æ** |
| Timeout —Ä–∏—Å–∫ | –ß–µ—Å—Ç–æ (120 –º–∏–Ω limit) | –ù—è–º–∞ (15 –º–∏–Ω –µ –¥–æ—Å—Ç–∞—Ç—ä—á–Ω–æ) | ‚úÖ |
| –ù–æ–≤ –ø—Ä–æ–¥—É–∫—Ç deploy | 93 –º–∏–Ω—É—Ç–∏ | **0 —Å–µ–∫—É–Ω–¥–∏** (ISR) | **‚àû –ø–æ-–±—ä—Ä–∑–æ** |

### SEO & Performance

| –ú–µ—Ç—Ä–∏–∫–∞ | –ü—Ä–µ–¥–∏ (SSG) | –°–ª–µ–¥ (ISR) | –°—Ç–∞—Ç—É—Å |
|---------|-------------|------------|--------|
| Fresh content | –°–ª–µ–¥ 93 –º–∏–Ω | –°–ª–µ–¥ 5-10 –º–∏–Ω | ‚úÖ –ú–Ω–æ–≥–æ –ø–æ-–¥–æ–±—Ä–æ |
| Crawlability | –û—Ç–ª–∏—á–Ω–∞ | –û—Ç–ª–∏—á–Ω–∞ | ‚úÖ –ï–¥–Ω–∞–∫–≤–æ |
| 404 –≥—Ä–µ—à–∫–∏ | `/marki`, `/contact` | –ù—è–º–∞ | ‚úÖFix-–Ω–∞—Ç–æ |
| Indexing –Ω–æ–≤–∏ –ø—Ä–æ–¥—É–∫—Ç–∏ | –ë–∞–≤–Ω–æ (93 –º–∏–Ω) | –ú–∏–≥–Ω–æ–≤–µ–Ω–æ | ‚úÖ –ú–Ω–æ–≥–æ –ø–æ-–¥–æ–±—Ä–æ |
| Core Web Vitals | –î–æ–±—Ä–æ | –û—Ç–ª–∏—á–Ω–æ (–∫–µ—à + fresh) | ‚úÖ –ü–æ-–¥–æ–±—Ä–æ |

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

| –ê—Å–ø–µ–∫—Ç | –ü—Ä–µ–¥–∏ (SSG) | –°–ª–µ–¥ (Node.js + ISR) |
|--------|-------------|----------------------|
| –¢–∏–ø | –°—Ç–∞—Ç–∏—á–Ω–∏ HTML —Ñ–∞–π–ª–æ–≤–µ | Node.js —Å—ä—Ä–≤—ä—Ä + ISR |
| –ë—Ä–æ–π –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∏ | 3644 (–≤—Å–∏—á–∫–∏ –Ω–∞–≤–µ–¥–Ω—ä–∂) | ~10 (–æ—Å—Ç–∞–Ω–∞–ª–∏—Ç–µ on-demand) |
| –ö–µ—à —Å—Ç—Ä–∞—Ç–µ–≥–∏—è | –ù—è–º–∞ (—Å—Ç–∞—Ä–∏ —Ñ–∞–π–ª–æ–≤–µ) | ISR (5-10 –º–∏–Ω refresh) |
| Downtime –ø—Ä–∏ deploy | ~30 —Å–µ–∫—É–Ω–¥–∏ | 0 —Å–µ–∫—É–Ω–¥–∏ (Passenger) |
| Process management | –ù—è–º–∞ | Passenger (auto-restart) |

---

## üîÑ Deployment Workflow

### –ü—Ä–µ–¥–∏ (SSG):

```
1. –ü—Ä–æ–º—è–Ω–∞ –≤ –∫–æ–¥
2. git push
3. GitHub Actions —Å—Ç–∞—Ä—Ç–∏—Ä–∞
4. Fetch 1223 –ø—Ä–æ–¥—É–∫—Ç–∞ –æ—Ç GraphQL (10+ –º–∏–Ω—É—Ç–∏)
5. Generate 3644 HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∏ (80+ –º–∏–Ω—É—Ç–∏)
6. Deploy —Å—Ç–∞—Ç–∏—á–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ
7. ~30 —Å–µ–∫—É–Ω–¥–∏ downtime
‚è±Ô∏è –û–ë–©–û: 93 –º–∏–Ω—É—Ç–∏
```

### –°–ª–µ–¥ (Node.js + ISR):

```
1. –ü—Ä–æ–º—è–Ω–∞ –≤ –∫–æ–¥
2. git push
3. GitHub Actions —Å—Ç–∞—Ä—Ç–∏—Ä–∞
4. Build Nuxt app (2 –º–∏–Ω—É—Ç–∏)
5. Deploy .output/ + package.json
6. npm install –Ω–∞ —Å—ä—Ä–≤—ä—Ä–∞ (30 —Å–µ–∫—É–Ω–¥–∏)
7. Passenger zero-downtime restart (5 —Å–µ–∫—É–Ω–¥–∏)
‚è±Ô∏è –û–ë–©–û: 3-5 –º–∏–Ω—É—Ç–∏
```

### –ù–æ–≤ –ø—Ä–æ–¥—É–∫—Ç workflow:

**–ü—Ä–µ–¥–∏:**
```
WordPress ‚Üí –ù–æ–≤ –ø—Ä–æ–¥—É–∫—Ç ‚Üí –ß–∞–∫–∞ 93 –º–∏–Ω ‚Üí Deploy ‚Üí –î–æ—Å—Ç—ä–ø–µ–Ω
```

**–°–ª–µ–¥:**
```
WordPress ‚Üí –ù–æ–≤ –ø—Ä–æ–¥—É–∫—Ç ‚Üí ISR ‚Üí –í–µ–¥–Ω–∞–≥–∞ –¥–æ—Å—Ç—ä–ø–µ–Ω!
                          (–≥–µ–Ω–µ—Ä–∏—Ä–∞ —Å–µ –ø—Ä–∏ –ø—ä—Ä–≤–∞ –∑–∞—è–≤–∫–∞)
```

---

## üéØ ISR –ü–æ–≤–µ–¥–µ–Ω–∏–µ

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∏ Incremental Static Regeneration?

```
–ó–∞—è–≤–∫–∞ 1 (t=0):
  ‚Üí –ù—è–º–∞ –∫–µ—à
  ‚Üí –ì–µ–Ω–µ—Ä–∏—Ä–∞ HTML (1-2 —Å–µ–∫—É–Ω–¥–∏)
  ‚Üí –ö–µ—à–∏—Ä–∞ –∑–∞ 5 –º–∏–Ω—É—Ç–∏
  ‚Üí –í—Ä—ä—â–∞ HTML

–ó–∞—è–≤–∫–∞ 2 (t=1 –º–∏–Ω—É—Ç–∞):
  ‚Üí –ò–º–∞ –∫–µ—à
  ‚Üí –í—Ä—ä—â–∞ –∫–µ—à–∏—Ä–∞–Ω HTML (< 50ms)
  
–ó–∞—è–≤–∫–∞ 3 (t=6 –º–∏–Ω—É—Ç–∏):
  ‚Üí –ö–µ—à—ä—Ç –∏–∑—Ç–µ—á–µ
  ‚Üí –í—Ä—ä—â–∞ —Å—Ç–∞—Ä–∏—è –∫–µ—à (–±—ä—Ä–∑–æ)
  ‚Üí –ù–∞ —Ñ–æ–Ω–∞ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–∞ –Ω–æ–≤ HTML
  
–ó–∞—è–≤–∫–∞ 4 (t=6.5 –º–∏–Ω—É—Ç–∏):
  ‚Üí –í—Ä—ä—â–∞ –Ω–æ–≤–∏—è HTML
```

### Route-specific –∫–µ—à –≤—Ä–µ–º–µ–Ω–∞:

| Route | Cache Time | –ü—Ä–∏—á–∏–Ω–∞ |
|-------|------------|---------|
| `/produkt/**` | 5 –º–∏–Ω—É—Ç–∏ | –ß–µ—Å—Ç–æ –ø—Ä–æ–º–µ–Ω—è—â–∏ —Å–µ —Ü–µ–Ω–∏/–Ω–∞–ª–∏—á–Ω–æ—Å—Ç–∏ |
| `/product-cat/**` | 10 –º–∏–Ω—É—Ç–∏ | –ü–æ-—Ä—è–¥–∫–æ –ø—Ä–æ–º–µ–Ω—è—â–∏ —Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ |
| `/product-tag/**` | 10 –º–∏–Ω—É—Ç–∏ | –¢–∞–≥–æ–≤–µ —Å–µ –ø—Ä–æ–º–µ–Ω—è—Ç —Ä—è–¥–∫–æ |
| `/marka-produkt/**` | 10 –º–∏–Ω—É—Ç–∏ | –ú–∞—Ä–∫–∏ —Å–µ –ø—Ä–æ–º–µ–Ω—è—Ç —Ä—è–¥–∫–æ |
| `/blog/**` | 10 –º–∏–Ω—É—Ç–∏ | –ë–ª–æ–≥ –ø–æ—Å—Ç–æ–≤–µ |
| `/magazin/**` | 5 –º–∏–Ω—É—Ç–∏ | –õ–∏—Å—Ç–∏–Ω–≥–∏ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏ |
| –°—Ç–∞—Ç–∏—á–Ω–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∏ | Forever | Home, Contact, etc. |

---

## üöÄ –°–ª–µ–¥–≤–∞—â–∏ –°—Ç—ä–ø–∫–∏

### 1. –ü—ä—Ä–≤–æ–Ω–∞—á–∞–ª–µ–Ω Deploy (20 –º–∏–Ω—É—Ç–∏ - –í–ï–î–ù–™–ñ)

–°–ª–µ–¥–≤–∞–π—Ç–µ: **QUICK_DEPLOY_INSTRUCTIONS.md**

### 2. Commit –ø—Ä–æ–º–µ–Ω–∏—Ç–µ

```bash
git add .
git commit -m "üöÄ Migrate from SSG to Node.js + Passenger + ISR

- Build –≤—Ä–µ–º–µ: 93 –º–∏–Ω ‚Üí 3 –º–∏–Ω
- Deploy –≤—Ä–µ–º–µ: 93 –º–∏–Ω ‚Üí 5 –º–∏–Ω
- –ù–æ–≤–∏ –ø—Ä–æ–¥—É–∫—Ç–∏: –ú–∏–≥–Ω–æ–≤–µ–Ω–æ (ISR)
- Fix 404 –≥—Ä–µ—à–∫–∏ –Ω–∞ /marki –∏ /contact
- Zero-downtime deploys —Å Passenger
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω restart –ø—Ä–∏ crash"

git push origin master
```

### 3. –ù–∞–±–ª—é–¥–∞–≤–∞–π—Ç–µ –ø—ä—Ä–≤–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω deploy

```
GitHub ‚Üí Actions tab
  
–û—á–∞–∫–≤–∞–Ω–æ –≤—Ä–µ–º–µ: 3-5 –º–∏–Ω—É—Ç–∏ (–≤–º–µ—Å—Ç–æ 93!)
```

### 4. –¢–µ—Å—Ç–≤–∞–Ω–µ

```bash
# –¢–µ—Å—Ç –Ω–∞ ISR
curl -w "\nTime: %{time_total}s\n" https://bgfreak.store/produkt/test

# –í—Ç–æ—Ä–∏ –ø—ä—Ç (—Ç—Ä—è–±–≤–∞ –¥–∞ –µ –º–Ω–æ–≥–æ –ø–æ-–±—ä—Ä–∑–æ)
curl -w "\nTime: %{time_total}s\n" https://bgfreak.store/produkt/test
```

---

## ‚úÖ Checklist

–ü—Ä–µ–¥–∏ commit:
- [x] `nuxt.config.ts` –ø—Ä–æ–º–µ–Ω–µ–Ω (ISR rules)
- [x] `package.json` –ø—Ä–æ–º–µ–Ω–µ–Ω (build script)
- [x] `.github/workflows/deploy.yml` –ø—Ä–æ–º–µ–Ω–µ–Ω
- [x] `app.mjs` —Å—ä–∑–¥–∞–¥–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω)
- [x] `.passenger` —Å—ä–∑–¥–∞–¥–µ–Ω
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å—ä–∑–¥–∞–¥–µ–Ω–∞
- [x] Lint check –º–∏–Ω–∞–≤–∞

–°–ª–µ–¥ –ø—ä—Ä–≤–æ–Ω–∞—á–∞–ª–µ–Ω deploy:
- [ ] cPanel Application Manager setup
- [ ] Environment variables –¥–æ–±–∞–≤–µ–Ω–∏
- [ ] Application —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–∞
- [ ] –í—Å–∏—á–∫–∏ URL-–æ–≤–µ —Ä–∞–±–æ—Ç—è—Ç
- [ ] ISR —Ç–µ—Å—Ç–≤–∞–Ω –∏ —Ä–∞–±–æ—Ç–∏
- [ ] GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω deploy —Ä–∞–±–æ—Ç–∏

---

## üéâ –†–ï–ó–£–õ–¢–ê–¢

### ‚úÖ –ü–æ—Å—Ç–∏–≥–Ω–∞—Ç–æ:

1. **31x –ø–æ-–±—ä—Ä–∑–æ build –≤—Ä–µ–º–µ** (93 –º–∏–Ω ‚Üí 3 –º–∏–Ω)
2. **–ú–∏–≥–Ω–æ–≤–µ–Ω–∏ –æ–±–Ω–æ–≤—è–≤–∞–Ω–∏—è** –Ω–∞ –Ω–æ–≤–∏ –ø—Ä–æ–¥—É–∫—Ç–∏ (ISR)
3. **Zero-downtime deploys** (Passenger)
4. **Fix –Ω–∞ 404 –≥—Ä–µ—à–∫–∏** (/marki, /contact)
5. **–ü–æ-–¥–æ–±—Ä–æ SEO** (fresh content, –±—ä—Ä–∑–æ indexing)
6. **Auto-restart –ø—Ä–∏ crash** (Passenger)
7. **100% –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω deployment** (GitHub Actions)

### üìà ROI:

- **–í—Ä–µ–º–µ —Å–ø–µ—Å—Ç–µ–Ω–æ –Ω–∞ deploy:** 88 –º–∏–Ω—É—Ç–∏ –Ω–∞ deploy
- **Deploy-–∏ –Ω–∞ –¥–µ–Ω:** ~2-3
- **–í—Ä–µ–º–µ —Å–ø–µ—Å—Ç–µ–Ω–æ –Ω–∞ –¥–µ–Ω:** ~3 —á–∞—Å–∞
- **–í—Ä–µ–º–µ —Å–ø–µ—Å—Ç–µ–Ω–æ –Ω–∞ –º–µ—Å–µ—Ü:** ~90 —á–∞—Å–∞

---

üöÄ **Migration –≥–æ—Ç–æ–≤–∞! –í—Ä–µ–º–µ –∑–∞ deploy!** üéâ

