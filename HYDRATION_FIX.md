# üîß –ü–æ–ø—Ä–∞–≤–∫–∞ –Ω–∞ SSR Hydration Mismatch –ø—Ä–∏ —Ñ–∏–ª—Ç—Ä–∏—Ç–µ

## üî¥ –ü—Ä–æ–±–ª–µ–º

–ü—Ä–∏ refresh –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∏ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–µ –ø–æ—è–≤—è–≤–∞—Ö–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ **Hydration Mismatch** –≥—Ä–µ—à–∫–∏:

```
[Vue warn]: Hydration node mismatch:
- rendered on server: <!--]-->  
- expected on client: div

[Vue warn]: Hydration children mismatch on <div>
Server rendered element contains fewer child nodes than client vdom.
```

–ì—Ä–µ—à–∫–∏—Ç–µ —Å–µ –ø–æ—è–≤—è–≤–∞—Ö–∞ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏—Ç–µ:
- `GlobalFilter`
- `PriceFilter`
- `CategoryFilter`
- `OnSaleFilter`

## üîç –ü—Ä–∏—á–∏–Ω–∞

**SSR vs Client –Ω–µ—Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ:**

1. **–ü—Ä–∏ SSR (Server Side Rendering):**
   - –§–∏–ª—Ç—Ä–∏—Ç–µ —Å–µ –æ–ø–∏—Ç–≤–∞—Ö–∞ –¥–∞ —Å–µ –∑–∞—Ä–µ–¥—è—Ç
   - –ö–µ—à—ä—Ç –≤—Ä—ä—â–∞—à–µ `null` –∑–∞—â–æ—Ç–æ `process.client = false`
   - `terms.value = []` (–ø—Ä–∞–∑–Ω–æ)
   - –§–∏–ª—Ç—Ä–∏—Ç–µ –ù–ï —Å–µ —Ä–µ–Ω–¥–∏—Ä–∞—Ö–∞

2. **–ü—Ä–∏ Client:**
   - `onMounted()` –∏–∑–≤–∏–∫–≤–∞—à–µ `loadTerms()`
   - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å–µ –∑–∞—Ä–µ–∂–¥–∞—Ö–∞ –¥–∞–Ω–Ω–∏ –æ—Ç GraphQL
   - `terms.value` —Å–µ –ø–æ–ø—ä–ª–≤–∞—à–µ —Å –¥–∞–Ω–Ω–∏
   - –§–∏–ª—Ç—Ä–∏—Ç–µ –°–ï —Ä–µ–Ω–¥–∏—Ä–∞—Ö–∞

3. **–†–µ–∑—É–ª—Ç–∞—Ç:**
   - Vue –æ—á–∞–∫–≤–∞—à–µ –µ–¥–Ω–æ (server HTML)
   - –ü–æ–ª—É—á–∞–≤–∞—à–µ –¥—Ä—É–≥–æ (client vdom)
   - **Hydration Mismatch** ‚Üí –ü—Ä–æ–¥—É–∫—Ç–∏—Ç–µ –∏–∑—á–µ–∑–≤–∞—Ö–∞!

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–û–±–≤–∏—Ö **–≤—Å–∏—á–∫–∏ —Ñ–∏–ª—Ç—Ä–∏** –≤ `<ClientOnly>` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞ –¥–∞ —Å–µ —Ä–µ–Ω–¥–∏—Ä–∞—Ç –°–ê–ú–û –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞:

### Desktop —Ñ–∏–ª—Ç—Ä–∏
```vue
<template>
  <ClientOnly>
    <aside id="filters" class="hidden lg:block">
      <div class="relative z-30 grid mb-12 space-y-8 divide-y">
        <PriceFilter />
        <CategoryFilter v-if="!hideCategories" :terms="productCategoryTerms" />
        <!-- ... –¥—Ä—É–≥–∏ —Ñ–∏–ª—Ç—Ä–∏ ... -->
      </div>
    </aside>
  </ClientOnly>
</template>
```

### Mobile —Ñ–∏–ª—Ç—Ä–∏
```vue
<template>
  <ClientOnly>
    <Teleport to="body">
      <aside id="mobile-filters" class="block lg:hidden">
        <!-- ... —Ñ–∏–ª—Ç—Ä–∏ ... -->
      </aside>
    </Teleport>
  </ClientOnly>
</template>
```

### –õ–æ–≥–∏–∫–∞ –∑–∞ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ
```javascript
// –ü–†–ï–î–ò: SSR + Client –ª–æ–≥–∏–∫–∞
if (categorySlug && categorySlug.trim().length > 0) {
  await loadTerms(); // –ü—Ä–∏ SSR
}

onMounted(() => {
  if (!categorySlug || categorySlug.trim().length === 0) {
    nextTick(() => {
      loadTerms(); // –ü—Ä–∏ Client
    });
  }
});

// –°–ï–ì–ê: –°–∞–º–æ Client –ª–æ–≥–∏–∫–∞
onMounted(() => {
  nextTick(() => {
    loadTerms(); // –í–∏–Ω–∞–≥–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞
  });
});
```

## üìÅ –ü—Ä–æ–º–µ–Ω–µ–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ

- `woonuxt_base/app/components/filtering/Filters.vue`

## üéØ –†–µ–∑—É–ª—Ç–∞—Ç

‚úÖ –ù—è–º–∞ –ø–æ–≤–µ—á–µ Hydration Mismatch –≥—Ä–µ—à–∫–∏  
‚úÖ –§–∏–ª—Ç—Ä–∏—Ç–µ —Å–µ —Ä–µ–Ω–¥–∏—Ä–∞—Ç –ø—Ä–∞–≤–∏–ª–Ω–æ  
‚úÖ –ü—Ä–æ–¥—É–∫—Ç–∏—Ç–µ –ù–ï –∏–∑—á–µ–∑–≤–∞—Ç –ø—Ä–∏ refresh  
‚úÖ –†–∞–±–æ—Ç–∏ –∫–∞–∫—Ç–æ –Ω–∞ desktop, —Ç–∞–∫–∞ –∏ –Ω–∞ mobile  
‚úÖ –ü–æ-–±—ä—Ä–∑–æ –ø—ä—Ä–≤–æ–Ω–∞—á–∞–ª–Ω–æ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ (SSR –Ω–µ —á–∞–∫–∞ —Ñ–∏–ª—Ç—Ä–∏—Ç–µ)  

## üìù –ó–∞—â–æ ClientOnly?

`<ClientOnly>` –∫–∞–∑–≤–∞ –Ω–∞ Vue:
- **–ü—Ä–∏ SSR**: –ù–ï —Ä–µ–Ω–¥–∏—Ä–∞–π —Ç–æ–≤–∞ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ
- **–ü—Ä–∏ Client**: –†–µ–Ω–¥–∏—Ä–∞–π –Ω–æ—Ä–º–∞–ª–Ω–æ —Å–ª–µ–¥ hydration

–¢–æ–≤–∞ –µ–ª–∏–º–∏–Ω–∏—Ä–∞ –Ω–µ—Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ—Ç–æ –º–µ–∂–¥—É server –∏ client HTML.

## üß™ –¢–µ—Å—Ç–≤–∞–Ω–µ

–ú–æ–ª—è, —Ç–µ—Å—Ç–≤–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ:

1. **–û—Ç–≤–æ—Ä–µ—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è:**
   ```
   http://localhost:3000/product-cat/–∞–Ω–∞–±–æ–ª–∏/—Ç–∞–±–ª–µ—Ç–Ω–∏-—Ñ–æ—Ä–º–∏-—Å—Ç–µ—Ä–æ–∏–¥–∏
   ```

2. **–ù–∞—Ç–∏—Å–Ω–µ—Ç–µ F5 (refresh)**

3. **–ü—Ä–æ–≤–µ—Ä–µ—Ç–µ:**
   - ‚úÖ –ù—è–º–∞ hydration –≥—Ä–µ—à–∫–∏ –≤ –∫–æ–Ω–∑–æ–ª–∞—Ç–∞
   - ‚úÖ –§–∏–ª—Ç—Ä–∏—Ç–µ —Å–µ –∑–∞—Ä–µ–∂–¥–∞—Ç
   - ‚úÖ –ü—Ä–æ–¥—É–∫—Ç–∏—Ç–µ –°–ï –ø–æ–∫–∞–∑–≤–∞—Ç (–Ω–µ –∏–∑—á–µ–∑–≤–∞—Ç)
   - ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞—Ç–∞ —Ä–∞–±–æ—Ç–∏ –Ω–æ—Ä–º–∞–ª–Ω–æ

## üí° –î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –ø–æ–ª–∑–∏

- **–ü–æ-–±—ä—Ä–∑–∞ SSR:** –ù–µ —Å–µ —á–∞–∫–∞ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ —Ñ–∏–ª—Ç—Ä–∏
- **–ü–æ-–ª–µ–∫ HTML:** SSR –Ω–µ –∏–∑–ø—Ä–∞—â–∞ –ø—Ä–∞–∑–µ–Ω —Ñ–∏–ª—Ç—ä—Ä–µ–Ω markup
- **–ü–æ-—á–∏—Å—Ç –∫–æ–¥:** –Ø—Å–Ω–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ SSR vs Client
- **–°—Ç–∞–±–∏–ª–Ω–æ—Å—Ç:** –ù—è–º–∞ race conditions –º–µ–∂–¥—É SSR –∏ Client

